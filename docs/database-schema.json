{
  "database_schema": {
    "users": {
      "id": "PRIMARY KEY, UUID",
      "email": "UNIQUE, VARCHAR(255), NOT NULL",
      "password_hash": "VARCHAR(255), NOT NULL",
      "first_name": "VARCHAR(100), NOT NULL",
      "last_name": "VARCHAR(100), NOT NULL",
      "role": "ENUM('admin', 'manager', 'sales', 'hr'), NOT NULL",
      "department": "VARCHAR(100)",
      "avatar_url": "TEXT",
      "is_active": "BOOLEAN, DEFAULT TRUE",
      "created_at": "TIMESTAMP, DEFAULT CURRENT_TIMESTAMP",
      "updated_at": "TIMESTAMP, DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP",
      "last_login": "TIMESTAMP",
      "preferences": "JSON"
    },
    "companies": {
      "id": "PRIMARY KEY, UUID",
      "name": "VARCHAR(255), NOT NULL",
      "domain": "VARCHAR(255)",
      "industry": "VARCHAR(100)",
      "size": "ENUM('1-10', '11-50', '51-200', '201-500', '501-1000', '1000+', 'unknown')",
      "revenue": "DECIMAL(15,2)",
      "description": "TEXT",
      "website": "VARCHAR(255)",
      "phone": "VARCHAR(50)",
      "address": "JSON",
      "created_at": "TIMESTAMP, DEFAULT CURRENT_TIMESTAMP",
      "updated_at": "TIMESTAMP, DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP"
    },
    "contacts": {
      "id": "PRIMARY KEY, UUID",
      "company_id": "UUID, FOREIGN KEY REFERENCES companies(id)",
      "first_name": "VARCHAR(100), NOT NULL",
      "last_name": "VARCHAR(100), NOT NULL",
      "email": "VARCHAR(255)",
      "phone": "VARCHAR(50)",
      "mobile": "VARCHAR(50)",
      "position": "VARCHAR(100)",
      "department": "VARCHAR(100)",
      "linkedin_url": "VARCHAR(255)",
      "is_primary": "BOOLEAN, DEFAULT FALSE",
      "created_at": "TIMESTAMP, DEFAULT CURRENT_TIMESTAMP",
      "updated_at": "TIMESTAMP, DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP"
    },
    "leads": {
      "id": "PRIMARY KEY, UUID",
      "contact_id": "UUID, FOREIGN KEY REFERENCES contacts(id)",
      "company_id": "UUID, FOREIGN KEY REFERENCES companies(id)",
      "assigned_to": "UUID, FOREIGN KEY REFERENCES users(id)",
      "source": "VARCHAR(100)",
      "stage": "ENUM('new', 'contacted', 'qualified', 'proposal', 'negotiation', 'won', 'lost')",
      "status": "ENUM('active', 'inactive', 'nurturing')",
      "score": "INTEGER, CHECK (score >= 0 AND score <= 100)",
      "estimated_value": "DECIMAL(15,2)",
      "probability": "INTEGER, CHECK (probability >= 0 AND probability <= 100)",
      "expected_close_date": "DATE",
      "last_contact_date": "DATE",
      "notes": "TEXT",
      "tags": "JSON",
      "created_at": "TIMESTAMP, DEFAULT CURRENT_TIMESTAMP",
      "updated_at": "TIMESTAMP, DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP"
    },
    "deals": {
      "id": "PRIMARY KEY, UUID",
      "lead_id": "UUID, FOREIGN KEY REFERENCES leads(id)",
      "name": "VARCHAR(255), NOT NULL",
      "value": "DECIMAL(15,2), NOT NULL",
      "stage": "ENUM('qualification', 'proposal', 'negotiation', 'closed_won', 'closed_lost')",
      "probability": "INTEGER, CHECK (probability >= 0 AND probability <= 100)",
      "expected_close_date": "DATE",
      "actual_close_date": "DATE",
      "assigned_to": "UUID, FOREIGN KEY REFERENCES users(id)",
      "description": "TEXT",
      "next_step": "TEXT",
      "created_at": "TIMESTAMP, DEFAULT CURRENT_TIMESTAMP",
      "updated_at": "TIMESTAMP, DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP"
    },
    "activities": {
      "id": "PRIMARY KEY, UUID",
      "subject": "VARCHAR(255), NOT NULL",
      "type": "ENUM('call', 'email', 'meeting', 'task', 'note', 'demo', 'proposal')",
      "direction": "ENUM('inbound', 'outbound')",
      "status": "ENUM('planned', 'completed', 'cancelled')",
      "priority": "ENUM('low', 'medium', 'high', 'urgent')",
      "description": "TEXT",
      "outcome": "TEXT",
      "duration": "INTEGER",
      "scheduled_at": "TIMESTAMP",
      "completed_at": "TIMESTAMP",
      "created_by": "UUID, FOREIGN KEY REFERENCES users(id)",
      "assigned_to": "UUID, FOREIGN KEY REFERENCES users(id)",
      "lead_id": "UUID, FOREIGN KEY REFERENCES leads(id)",
      "deal_id": "UUID, FOREIGN KEY REFERENCES deals(id)",
      "contact_id": "UUID, FOREIGN KEY REFERENCES contacts(id)",
      "created_at": "TIMESTAMP, DEFAULT CURRENT_TIMESTAMP",
      "updated_at": "TIMESTAMP, DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP"
    },
    "tasks": {
      "id": "PRIMARY KEY, UUID",
      "title": "VARCHAR(255), NOT NULL",
      "description": "TEXT",
      "status": "ENUM('open', 'in_progress', 'completed', 'cancelled')",
      "priority": "ENUM('low', 'medium', 'high', 'urgent')",
      "due_date": "TIMESTAMP",
      "completed_at": "TIMESTAMP",
      "created_by": "UUID, FOREIGN KEY REFERENCES users(id)",
      "assigned_to": "UUID, FOREIGN KEY REFERENCES users(id)",
      "related_type": "ENUM('lead', 'deal', 'contact', 'activity')",
      "related_id": "UUID",
      "created_at": "TIMESTAMP, DEFAULT CURRENT_TIMESTAMP",
      "updated_at": "TIMESTAMP, DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP"
    },
    "meetings": {
      "id": "PRIMARY KEY, UUID",
      "title": "VARCHAR(255), NOT NULL",
      "description": "TEXT",
      "start_time": "TIMESTAMP, NOT NULL",
      "end_time": "TIMESTAMP, NOT NULL",
      "location": "VARCHAR(255)",
      "meeting_url": "VARCHAR(255)",
      "status": "ENUM('scheduled', 'completed', 'cancelled', 'no_show')",
      "meeting_type": "ENUM('sales_call', 'demo', 'discovery', 'proposal', 'negotiation', 'internal')",
      "organizer_id": "UUID, FOREIGN KEY REFERENCES users(id)",
      "lead_id": "UUID, FOREIGN KEY REFERENCES leads(id)",
      "deal_id": "UUID, FOREIGN KEY REFERENCES deals(id)",
      "summary": "TEXT",
      "action_items": "JSON",
      "recording_url": "VARCHAR(255)",
      "created_at": "TIMESTAMP, DEFAULT CURRENT_TIMESTAMP",
      "updated_at": "TIMESTAMP, DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP"
    },
    "meeting_attendees": {
      "id": "PRIMARY KEY, UUID",
      "meeting_id": "UUID, FOREIGN KEY REFERENCES meetings(id)",
      "user_id": "UUID, FOREIGN KEY REFERENCES users(id), NULL",
      "contact_id": "UUID, FOREIGN KEY REFERENCES contacts(id), NULL",
      "email": "VARCHAR(255)",
      "name": "VARCHAR(255)",
      "response": "ENUM('pending', 'accepted', 'declined', 'tentative')",
      "attended": "BOOLEAN, DEFAULT FALSE",
      "created_at": "TIMESTAMP, DEFAULT CURRENT_TIMESTAMP"
    },
    "emails": {
      "id": "PRIMARY KEY, UUID",
      "subject": "VARCHAR(500), NOT NULL",
      "body": "TEXT",
      "from_email": "VARCHAR(255), NOT NULL",
      "to_emails": "JSON, NOT NULL",
      "cc_emails": "JSON",
      "bcc_emails": "JSON",
      "direction": "ENUM('inbound', 'outbound')",
      "status": "ENUM('draft', 'sent', 'delivered', 'opened', 'clicked', 'replied', 'bounced')",
      "thread_id": "VARCHAR(255)",
      "message_id": "VARCHAR(255), UNIQUE",
      "sent_at": "TIMESTAMP",
      "opened_at": "TIMESTAMP",
      "user_id": "UUID, FOREIGN KEY REFERENCES users(id)",
      "lead_id": "UUID, FOREIGN KEY REFERENCES leads(id)",
      "deal_id": "UUID, FOREIGN KEY REFERENCES deals(id)",
      "contact_id": "UUID, FOREIGN KEY REFERENCES contacts(id)",
      "created_at": "TIMESTAMP, DEFAULT CURRENT_TIMESTAMP",
      "updated_at": "TIMESTAMP, DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP"
    },
    "email_templates": {
      "id": "PRIMARY KEY, UUID",
      "name": "VARCHAR(255), NOT NULL",
      "subject": "VARCHAR(500), NOT NULL",
      "body": "TEXT, NOT NULL",
      "template_type": "ENUM('cold_outreach', 'follow_up', 'proposal', 'demo_invite', 'meeting_reminder')",
      "is_active": "BOOLEAN, DEFAULT TRUE",
      "created_by": "UUID, FOREIGN KEY REFERENCES users(id)",
      "created_at": "TIMESTAMP, DEFAULT CURRENT_TIMESTAMP",
      "updated_at": "TIMESTAMP, DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP"
    },
    "sequences": {
      "id": "PRIMARY KEY, UUID",
      "name": "VARCHAR(255), NOT NULL",
      "description": "TEXT",
      "is_active": "BOOLEAN, DEFAULT TRUE",
      "created_by": "UUID, FOREIGN KEY REFERENCES users(id)",
      "created_at": "TIMESTAMP, DEFAULT CURRENT_TIMESTAMP",
      "updated_at": "TIMESTAMP, DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP"
    },
    "sequence_steps": {
      "id": "PRIMARY KEY, UUID",
      "sequence_id": "UUID, FOREIGN KEY REFERENCES sequences(id)",
      "step_number": "INTEGER, NOT NULL",
      "step_type": "ENUM('email', 'call', 'linkedin', 'wait')",
      "delay_days": "INTEGER, DEFAULT 0",
      "template_id": "UUID, FOREIGN KEY REFERENCES email_templates(id), NULL",
      "subject": "VARCHAR(500)",
      "body": "TEXT",
      "is_active": "BOOLEAN, DEFAULT TRUE",
      "created_at": "TIMESTAMP, DEFAULT CURRENT_TIMESTAMP"
    },
    "lead_sequences": {
      "id": "PRIMARY KEY, UUID",
      "lead_id": "UUID, FOREIGN KEY REFERENCES leads(id)",
      "sequence_id": "UUID, FOREIGN KEY REFERENCES sequences(id)",
      "current_step": "INTEGER, DEFAULT 1",
      "status": "ENUM('active', 'paused', 'completed', 'stopped')",
      "started_at": "TIMESTAMP, DEFAULT CURRENT_TIMESTAMP",
      "next_action_at": "TIMESTAMP",
      "completed_at": "TIMESTAMP"
    },
    "employees": {
      "id": "PRIMARY KEY, UUID",
      "user_id": "UUID, FOREIGN KEY REFERENCES users(id)",
      "employee_id": "VARCHAR(100), UNIQUE",
      "hire_date": "DATE, NOT NULL",
      "termination_date": "DATE",
      "employment_status": "ENUM('active', 'inactive', 'terminated')",
      "job_title": "VARCHAR(255)",
      "department": "VARCHAR(100)",
      "manager_id": "UUID, FOREIGN KEY REFERENCES employees(id)",
      "salary": "DECIMAL(15,2)",
      "hourly_rate": "DECIMAL(10,2)",
      "employment_type": "ENUM('full_time', 'part_time', 'contract', 'intern')",
      "location": "VARCHAR(255)",
      "created_at": "TIMESTAMP, DEFAULT CURRENT_TIMESTAMP",
      "updated_at": "TIMESTAMP, DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP"
    },
    "attendance": {
      "id": "PRIMARY KEY, UUID",
      "employee_id": "UUID, FOREIGN KEY REFERENCES employees(id)",
      "date": "DATE, NOT NULL",
      "check_in": "TIME",
      "check_out": "TIME",
      "break_duration": "INTEGER, DEFAULT 0",
      "hours_worked": "DECIMAL(4,2)",
      "overtime_hours": "DECIMAL(4,2)",
      "status": "ENUM('present', 'absent', 'late', 'half_day', 'holiday', 'sick_leave')",
      "notes": "TEXT",
      "approved_by": "UUID, FOREIGN KEY REFERENCES users(id)",
      "created_at": "TIMESTAMP, DEFAULT CURRENT_TIMESTAMP",
      "updated_at": "TIMESTAMP, DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP",
      "INDEX": "employee_id, date"
    },
    "leave_requests": {
      "id": "PRIMARY KEY, UUID",
      "employee_id": "UUID, FOREIGN KEY REFERENCES employees(id)",
      "leave_type": "ENUM('vacation', 'sick', 'personal', 'bereavement', 'maternity', 'paternity')",
      "start_date": "DATE, NOT NULL",
      "end_date": "DATE, NOT NULL",
      "days_requested": "DECIMAL(3,1), NOT NULL",
      "reason": "TEXT",
      "status": "ENUM('pending', 'approved', 'rejected', 'cancelled')",
      "requested_at": "TIMESTAMP, DEFAULT CURRENT_TIMESTAMP",
      "reviewed_by": "UUID, FOREIGN KEY REFERENCES users(id)",
      "reviewed_at": "TIMESTAMP",
      "reviewer_notes": "TEXT",
      "created_at": "TIMESTAMP, DEFAULT CURRENT_TIMESTAMP",
      "updated_at": "TIMESTAMP, DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP"
    },
    "workflows": {
      "id": "PRIMARY KEY, UUID",
      "name": "VARCHAR(255), NOT NULL",
      "description": "TEXT",
      "workflow_type": "ENUM('onboarding', 'leave_approval', 'performance_review', 'offboarding')",
      "trigger_event": "VARCHAR(255)",
      "is_active": "BOOLEAN, DEFAULT TRUE",
      "created_by": "UUID, FOREIGN KEY REFERENCES users(id)",
      "created_at": "TIMESTAMP, DEFAULT CURRENT_TIMESTAMP",
      "updated_at": "TIMESTAMP, DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP"
    },
    "workflow_steps": {
      "id": "PRIMARY KEY, UUID",
      "workflow_id": "UUID, FOREIGN KEY REFERENCES workflows(id)",
      "step_number": "INTEGER, NOT NULL",
      "name": "VARCHAR(255), NOT NULL",
      "description": "TEXT",
      "assignee_role": "VARCHAR(100)",
      "assignee_id": "UUID, FOREIGN KEY REFERENCES users(id)",
      "due_days": "INTEGER",
      "is_required": "BOOLEAN, DEFAULT TRUE",
      "created_at": "TIMESTAMP, DEFAULT CURRENT_TIMESTAMP"
    },
    "workflow_instances": {
      "id": "PRIMARY KEY, UUID",
      "workflow_id": "UUID, FOREIGN KEY REFERENCES workflows(id)",
      "subject_type": "ENUM('employee', 'lead', 'deal')",
      "subject_id": "UUID, NOT NULL",
      "status": "ENUM('active', 'completed', 'cancelled', 'failed')",
      "current_step": "INTEGER",
      "started_by": "UUID, FOREIGN KEY REFERENCES users(id)",
      "started_at": "TIMESTAMP, DEFAULT CURRENT_TIMESTAMP",
      "completed_at": "TIMESTAMP",
      "created_at": "TIMESTAMP, DEFAULT CURRENT_TIMESTAMP",
      "updated_at": "TIMESTAMP, DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP"
    },
    "integrations": {
      "id": "PRIMARY KEY, UUID",
      "name": "VARCHAR(255), NOT NULL",
      "type": "ENUM('email', 'calendar', 'social', 'communication', 'productivity')",
      "provider": "VARCHAR(100), NOT NULL",
      "user_id": "UUID, FOREIGN KEY REFERENCES users(id)",
      "credentials": "JSON",
      "settings": "JSON",
      "is_active": "BOOLEAN, DEFAULT TRUE",
      "last_sync": "TIMESTAMP",
      "created_at": "TIMESTAMP, DEFAULT CURRENT_TIMESTAMP",
      "updated_at": "TIMESTAMP, DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP"
    },
    "ai_insights": {
      "id": "PRIMARY KEY, UUID",
      "type": "ENUM('lead_scoring', 'deal_prediction', 'persona_match', 'next_action', 'opportunity')",
      "subject_type": "ENUM('lead', 'deal', 'contact', 'general')",
      "subject_id": "UUID",
      "title": "VARCHAR(255), NOT NULL",
      "description": "TEXT",
      "confidence_score": "DECIMAL(3,2), CHECK (confidence_score >= 0 AND confidence_score <= 1)",
      "recommendations": "JSON",
      "status": "ENUM('active', 'acknowledged', 'dismissed')",
      "generated_at": "TIMESTAMP, DEFAULT CURRENT_TIMESTAMP",
      "acknowledged_by": "UUID, FOREIGN KEY REFERENCES users(id)",
      "acknowledged_at": "TIMESTAMP"
    },
    "lead_personas": {
      "id": "PRIMARY KEY, UUID",
      "name": "VARCHAR(255), NOT NULL",
      "description": "TEXT",
      "industries": "JSON",
      "job_titles": "JSON",
      "company_sizes": "JSON",
      "avg_deal_value": "DECIMAL(15,2)",
      "conversion_rate": "DECIMAL(5,4)",
      "avg_sales_cycle": "INTEGER",
      "key_indicators": "JSON",
      "is_active": "BOOLEAN, DEFAULT TRUE",
      "created_by": "UUID, FOREIGN KEY REFERENCES users(id)",
      "created_at": "TIMESTAMP, DEFAULT CURRENT_TIMESTAMP",
      "updated_at": "TIMESTAMP, DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP"
    },
    "audit_logs": {
      "id": "PRIMARY KEY, UUID",
      "user_id": "UUID, FOREIGN KEY REFERENCES users(id)",
      "action": "VARCHAR(100), NOT NULL",
      "entity_type": "VARCHAR(100), NOT NULL",
      "entity_id": "UUID, NOT NULL",
      "old_values": "JSON",
      "new_values": "JSON",
      "ip_address": "VARCHAR(45)",
      "user_agent": "TEXT",
      "created_at": "TIMESTAMP, DEFAULT CURRENT_TIMESTAMP"
    }
  },
  "indexes": [
    "CREATE INDEX idx_leads_assigned_to ON leads(assigned_to)",
    "CREATE INDEX idx_leads_stage ON leads(stage)",
    "CREATE INDEX idx_leads_created_at ON leads(created_at)",
    "CREATE INDEX idx_deals_assigned_to ON deals(assigned_to)",
    "CREATE INDEX idx_deals_stage ON deals(stage)",
    "CREATE INDEX idx_activities_assigned_to ON activities(assigned_to)",
    "CREATE INDEX idx_activities_type ON activities(type)",
    "CREATE INDEX idx_activities_scheduled_at ON activities(scheduled_at)",
    "CREATE INDEX idx_tasks_assigned_to ON tasks(assigned_to)",
    "CREATE INDEX idx_tasks_due_date ON tasks(due_date)",
    "CREATE INDEX idx_emails_thread_id ON emails(thread_id)",
    "CREATE INDEX idx_attendance_employee_date ON attendance(employee_id, date)",
    "CREATE INDEX idx_audit_logs_entity ON audit_logs(entity_type, entity_id)",
    "CREATE INDEX idx_audit_logs_user_created ON audit_logs(user_id, created_at)"
  ],
  "relationships": [
    "leads.contact_id → contacts.id",
    "leads.company_id → companies.id",
    "leads.assigned_to → users.id",
    "deals.lead_id → leads.id",
    "deals.assigned_to → users.id",
    "activities.created_by → users.id",
    "activities.assigned_to → users.id",
    "activities.lead_id → leads.id",
    "activities.deal_id → deals.id",
    "activities.contact_id → contacts.id",
    "tasks.created_by → users.id",
    "tasks.assigned_to → users.id",
    "meetings.organizer_id → users.id",
    "meetings.lead_id → leads.id",
    "meetings.deal_id → deals.id",
    "employees.user_id → users.id",
    "employees.manager_id → employees.id",
    "attendance.employee_id → employees.id",
    "leave_requests.employee_id → employees.id"
  ]
}